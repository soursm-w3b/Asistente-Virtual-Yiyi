<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Yiyi ‚Äî SyMEC (Onyx)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes floaty { 0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)} }
    .floaty{ animation: floaty 3s ease-in-out infinite; }
    .typing-dots span{ display:inline-block; width:6px; height:6px; margin:0 3px; border-radius:999px; background:rgba(255,255,255,0.6); transform:scale(0.6); animation: blink 1s infinite; }
    .typing-dots span:nth-child(2){ animation-delay:.15s } .typing-dots span:nth-child(3){ animation-delay:.3s }
    @keyframes blink { 0%{transform:scale(0.6);opacity:0.4}50%{transform:scale(1);opacity:1}100%{transform:scale(0.6);opacity:0.4} }

    .bubble-user{ background: linear-gradient(90deg,#a5f3fc,#60a5fa); color:#03203C; }
    .bubble-assistant{ background: linear-gradient(90deg,#f3f4f6,#e6e9ef); color:#0b1220; }

    .card-anim{ transform-origin:center; transition: transform .28s cubic-bezier(.2,.9,.3,1), box-shadow .28s; }
    .card-anim:hover{ transform: translateY(-6px) scale(1.01); box-shadow: 0 14px 35px rgba(8,15,30,0.12); }

    .glass{ background: rgba(255,255,255,0.06); backdrop-filter: blur(6px); }
    .scrollbar-thin::-webkit-scrollbar{ height:8px; width:8px; }
    .scrollbar-thin::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.12); border-radius:8px; }

    pre { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; font-size:13px; }

    /* Catalog utils */
    .hiddenItem { display:none; }
    .toggleBtn { background: #ff6ad5; color: white; padding: 6px 10px; border: none; border-radius: 8px; margin-top: 6px; cursor: pointer; }
    .catalog-item { transition: all .18s ease; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-indigo-900 to-purple-900 text-slate-100 min-h-screen">

  <div class="max-w-7xl mx-auto p-6 grid grid-cols-1 lg:grid-cols-4 gap-6">

    <!-- Left: Branding & quick actions -->
    <aside class="lg:col-span-1 rounded-2xl p-5 glass border border-white/6">
      <div class="flex items-center gap-3">
        <div class="w-16 h-16 rounded-xl bg-gradient-to-r from-pink-500 to-violet-500 flex items-center justify-center floaty overflow-hidden">
          <!-- Replace `1.png` with your actual logo path if needed -->
          <img src="1.png" class="w-12 h-12 object-contain" alt="Yiyi logo"/>
        </div>
        <div>
          <h1 class="text-xl font-semibold">Yiyi ‚Äî SyMEC Hub</h1>
          <p class="text-sm text-slate-300">Soporte y Mantenimiento de Equipo de C√≥mputo</p>
        </div>
      </div>

      <div class="mt-5">
        <input id="kbSearch" aria-label="Buscar en KB" class="w-full rounded-xl p-2 bg-white/5 placeholder:text-slate-300 outline-none" placeholder="Buscar en la base local (ej: 'SSD', 'BIOS', 'imaging')" />
      </div>

      <div class="mt-4 grid grid-cols-2 gap-3">
        <button id="openChat" class="rounded-xl py-2 bg-gradient-to-r from-sky-500 to-indigo-500 text-sm font-medium">Abrir Chat</button>
        <button id="openKB" class="rounded-xl py-2 bg-gradient-to-r from-rose-500 to-orange-400 text-sm font-medium">Abrir Cat√°logo</button>
      </div>

      <div class="mt-6 text-xs text-slate-400 space-y-2">
        <div class="flex items-start gap-2">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 12h18M3 6h18M3 18h18"/></svg>
          <div>
            <strong class="text-slate-100">Modo offline</strong>
            <div class="text-slate-400">Toda la informaci√≥n est√° guardada localmente.</div>
          </div>
        </div>

        <div class="flex items-start gap-2">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 2v20M2 12h20"/></svg>
          <div>
            <strong class="text-slate-100">Importar / Exportar</strong>
            <div class="text-slate-400">Guarda o restaura tu KB en JSON.</div>
          </div>
        </div>
      </div>

      <div class="mt-6">
        <small class="text-slate-500">Versi√≥n:</small>
        <div class="mt-1 text-xs text-slate-300">Yiyi SyMEC 2.4 ¬∑ Onyx</div>
      </div>
    </aside>

    <!-- Middle: Chat area -->
    <main id="chatPanel" class="lg:col-span-2 rounded-2xl p-5 glass border border-white/6 flex flex-col min-h-[520px]">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-lg font-semibold">Chat t√©cnico</h2>
          <p class="text-sm text-slate-400">Preg√∫ntale a Yiyi sobre procedimientos, comandos y consejos pr√°cticos.</p>
        </div>
        <div class="flex items-center gap-3">
          <button id="btnVoice" title="Reconocimiento de voz" class="p-2 rounded-xl bg-white/6 hover:bg-white/8">üéôÔ∏è</button>
          <button id="btnClear" title="Borrar historial" class="p-2 rounded-xl bg-white/6 hover:bg-white/8">üßπ Limpiar</button>
        </div>
      </div>

      <div id="messages" class="mt-4 overflow-auto flex-1 space-y-3 p-3 rounded-xl bg-gradient-to-b from-white/2 to-transparent scrollbar-thin" aria-live="polite"></div>

      <div class="mt-4 flex gap-3 items-end">
        <textarea id="inputMsg" rows="2" class="flex-1 rounded-2xl p-3 resize-none bg-white/5 outline-none" placeholder="Escribe aqu√≠... (ej: '¬øC√≥mo clono un disco a otro SSD?')"></textarea>
        <div class="flex flex-col gap-2">
          <button id="sendBtn" class="px-4 py-2 rounded-2xl bg-gradient-to-r from-emerald-400 to-teal-400 text-black font-semibold">Enviar</button>
          <button id="btnQuick" class="px-3 py-2 rounded-2xl bg-white/6 text-sm">Plantillas</button>
        </div>
      </div>
    </main>

    <!-- Right: Knowledge base catalog -->
    <aside id="kbPanel" class="lg:col-span-1 rounded-2xl p-5 glass border border-white/6 overflow-auto min-h-[520px]">
      <div class="flex items-center justify-between">
        <div>
          <h3 class="text-lg font-semibold">Cat√°logo SyMEC</h3>
          <p class="text-sm text-slate-400">Categor√≠as, gu√≠as paso a paso y cheatsheets.</p>
        </div>
        <div>
          <button id="exportKB" class="text-xs px-2 py-1 rounded-xl bg-white/6">Exportar JSON</button>
        </div>
      </div>

      <div id="kbList" class="mt-4 space-y-3"></div>

      <div class="mt-4">
        <h4 class="text-sm font-medium">Modo de estudio</h4>
        <p class="text-xs text-slate-400">Genera tarjetas de repaso desde cualquier tema.</p>
        <button id="studyBtn" class="mt-2 px-3 py-2 rounded-xl bg-gradient-to-r from-indigo-500 to-violet-500 text-sm">Iniciar flashcards</button>
      </div>

      <div class="mt-4 text-xs text-slate-400">
        <strong>Atajos:</strong>
        <ul class="list-disc ml-5 mt-2">
          <li>Ctrl+K: foco en b√∫squeda</li>
          <li>Ctrl+Enter: enviar mensaje</li>
        </ul>
      </div>
    </aside>

  </div>

  <div id="modalRoot"></div>

  <script>
    /* ---------------------------
       UTILIDADES Y DATOS
    --------------------------- */
    const $ = (id) => document.getElementById(id);
    function uid(prefix='id'){ return prefix + Math.random().toString(36).slice(2,9); }

    const kbSearch = $('kbSearch');
    const messagesEl = $('messages');
    const inputMsg = $('inputMsg');
    const sendBtn = $('sendBtn');
    const openChat = $('openChat');
    const openKB = $('openKB');
    const kbList = $('kbList');
    const exportKB = $('exportKB');
    const studyBtn = $('studyBtn');
    const btnClear = $('btnClear');
    const btnVoice = $('btnVoice');
    const btnQuick = $('btnQuick');
    const modalRoot = $('modalRoot');

    const KB_KEY = 'yiyi_kb_v2';
    const MSG_KEY = 'yiyi_msgs_v2';
    const MAX_VISIBLE_ITEMS = 2; // l√≠mite por categor√≠a

    /* ---------- Base de conocimiento local (ejemplo) ---------- */    

let kbModules = [
      {
        id: 'hardware-basics',
        title: 'Hardware ‚Äî Conceptos y Diagn√≥stico',
        items: [
          { id:'cpu-identify', title:'Identificaci√≥n de CPU y sockets', tags:['CPU','socket'], summary:'C√≥mo identificar el procesador y socket', content: `*En Windows:*
1. Abre "Administrador de dispositivos" > "Procesadores".
2. Usa el comando en CMD: wmic cpu get name
3. Usa software como CPU-Z (pesta√±a CPU).

*En Linux:*
lscpu o cat /proc/cpuinfo | grep "model name"

*Identificar el Socket:*
Una vez que tengas el modelo de CPU (ej: AMD Ryzen 5 5600X, Intel Core i7-12700K), busca su ficha t√©cnica en la web del fabricante. El socket para el Ryzen 5 5600X es AM4, y para el i7-12700K es LGA 1700.
`},
          {
            id:'ram-troubleshoot', title:'Diagn√≥stico y test de memoria RAM', tags:['RAM','memtest'], summary:'Detectar fallas en memoria', content: `*S√≠ntomas de RAM defectuosa:*
- Pantallazos azules (BSOD) frecuentes
- Aplicaciones se cierran inesperadamente
- Equipo no enciende o emite beeps
- Archivos se corrompen

*Procedimiento de diagn√≥stico:*
1. MemTest86: Crear USB booteable, ejecutar m√≠nimo 4 pases
2. Prueba f√≠sica: Probar m√≥dulos individualmente en diferentes slots
3. Limpieza: Limpiar contactos con borrador de goma blanda
4. BIOS/UEFI: Verificar configuraci√≥n XMP/DOCP y voltajes

*Soluciones comunes:*
- Reacomodar m√≥dulos en slots diferentes
- Restablecer configuraci√≥n BIOS a valores por defecto
- Actualizar BIOS/UEFI a la √∫ltima versi√≥n
`},
          { id:'psu-check', title:'Comprobar fuente de alimentaci√≥n (PSU)', tags:['PSU','fuente'], summary:'Pruebas para diagnosticar estado de la fuente de poder', content:`*Se√±ales de alarma:*
      - Equipo se reinicia bajo carga alta
      - Olores a quemado o chispas
      - Voltajes inestables (medir con mult√≠metro)

      *Pruebas b√°sicas:*
      1. *Test del clip/jumper:* Conectar pin verde (PS_ON) a negro (GND) en conector 24-pin
      2. *Mult√≠metro:* Verificar voltajes en rails principales:
         - +12V (amarillo): 11.4V - 12.6V
         - +5V (rojo): 4.75V - 5.25V  
         - +3.3V (naranja): 3.14V - 3.47V

      *Factores de reemplazo:*
      - Edad mayor a 5-7 a√±os
      - Capacidad insuficiente para componentes actuales
      - Marcas de baja calidad o sin certificaci√≥n 80 Plus` },

          { id:'motherboard-components', title:'Componentes cr√≠ticos de la placa base', tags:['motherboard','placa base'], summary:'Identificaci√≥n y funci√≥n de los componentes principales', content:`*Componentes esenciales y su funci√≥n:*

      *1. Socket CPU:* Determina compatibilidad con procesadores
      *2. Slots RAM:* DDR4/DDR5, canales dual/quad
      *3. PCIe Slots:* Para GPU y tarjetas de expansi√≥n
      *4. Conectores SATA/Power:* Alimentaci√≥n y almacenamiento
      *5. BIOS/UEFI Chip:* Firmware que controla hardware b√°sico
      *6. CMOS Battery:* Mantiene configuraci√≥n y hora del sistema

      *Problemas comunes:*
      - *BIOS corrupto:* Equipo no POST, recovery mode necesario
      - *CMOS agotada:* Configuraci√≥n BIOS no se guarda
      - *Capacitores inflados:* Fallas de energ√≠a, inestabilidad`
    },
        
{
      id:'cooling-solutions',
      title:'Sistemas de refrigeraci√≥n y mantenimiento',
      tags:['refrigeraci√≥n', 'temperaturas', 'ventiladores', 'thermal-paste'], summary:'Tipos de refrigeraci√≥n y mantenimiento preventivo',
      content:`*Tipos de refrigeraci√≥n:*

      *Aire:*
      - *Stock cooler:* Incluido con CPU, suficiente para uso b√°sico
      - *Aftermarket:* Mejor rendimiento ac√∫stico y t√©rmico

      *L√≠quida:*
      - *AIO (All-in-One):* F√°cil instalaci√≥n, buen rendimiento
      - *Custom Loop:* M√°ximo rendimiento, mantenimiento complejo

      *Mantenimiento preventivo:*
      1. *Limpieza:* Soplador de aire cada 3-6 meses
      2. *Pasta t√©rmica:* Cambiar cada 2-3 a√±os
      3. *Filtros:* Limpiar mensualmente en ambientes polvorientos

      *Temperaturas normales:*
      - CPU: 35-45¬∞C idle, 65-85¬∞C bajo carga
      - GPU: 40-50¬∞C idle, 70-85¬∞C gaming`
    },
{
      id:'post-beep-codes',
      title:'C√≥digos POST y beeps de diagn√≥stico',
      tags:['POST', 'beeps', 'diagn√≥stico', 'bios', 'motherboard'],
      summary:'Interpretaci√≥n de c√≥digos audibles durante el arranque',
      content:`*C√≥digos POST comunes (patrones de beeps):*

      *AMI BIOS:*
      - 1 beep: POST exitoso
      - 2 beeps: Error de paridad RAM
      - 3 beeps: Error en primeros 64KB de RAM
      - 5 beeps: Error de CPU
      - 8 beeps: Error de GPU

      *Award/Phoenix BIOS:*
      - 1 beep largo: Error de memoria
      - 1 beep largo, 2 cortos: Error de GPU
      - Beeps continuos: Problema de alimentaci√≥n

      *Procedimiento:*
      1. Anotar patr√≥n exacto de beeps
      2. Consultar manual de la motherboard
      3. Probar componentes m√≠nimos (CPU, 1 RAM, PSU)`
    },
{
      id: 'thermal-paste-application',
      title: 'Aplicaci√≥n correcta de pasta t√©rmica',
      tags: ['pasta t√©rmica', 'cpu', 'refrigeraci√≥n', 'aplicaci√≥n'],
      summary: 'T√©cnicas adecuadas para aplicar pasta t√©rmica en diferentes tipos de CPU',
      content: `*M√©todos de aplicaci√≥n recomendados:*

      *Para CPUs cuadradas (Intel):*
      - *M√©todo del guisante:* Pea-sized dot en el centro
      - *M√©todo de la l√≠nea:* L√≠nea vertical para CPUs largas
      - *M√©todo de la X:* Para distribuci√≥n m√°s uniforme

      *Para CPUs rectangulares (AMD Ryzen):*
      - *M√©todo de la l√≠nea:* L√≠nea horizontal en el centro
      - *M√©todo de la doble l√≠nea:* Para CPUs m√°s grandes

      *Cantidad correcta:*
      - Demasiada poco: Sobrecalentamiento
      - Demasiada mucho: Derrames y posibles cortocircuitos
      - Cantidad ideal: 1-2 granos de arroz

      *Tipos de pasta t√©rmica:*
      - Basada en silicona: F√°cil aplicaci√≥n, duraci√≥n media
      - Met√°lica: Mejor conductividad, pero conductora el√©ctrica
      - Cer√°mica: No conductora, buen rendimiento`
    },
{
      id: 'cable-management',
      title: 'Gesti√≥n de cables y flujo de aire',
      tags: ['cables', 'gesti√≥n', 'flujo de aire', 'temperaturas'],
      summary: 'T√©cnicas para organizar cables y optimizar la refrigeraci√≥n del sistema',
      content: `*Beneficios de buena gesti√≥n de cables:*
      - Mejor flujo de aire y menores temperaturas
      - M√°s f√°cil mantenimiento y upgrades
      - Mejor est√©tica y menos acumulaci√≥n de polvo

      *T√©cnicas b√°sicas:*
      1. *Planificaci√≥n:* Route cables antes de atar
      2. *Uso de espacios:* Behind motherboard tray
      3. *Agrupaci√≥n:* Bundle similar cables together
      4. *Atenci√≥n a ventiladores:* Don't block intake/exhaust

      *Herramientas recomendadas:*
      - Velcro straps (reutilizables)
      - Zip ties (permanentes pero ordenados)
      - Cable combs para cables modulares
      - Extensiones cableadas para mejor routing`
    },
{
      id: 'bios-update-guide',
      title: 'Actualizaci√≥n segura del BIOS/UEFI',
      tags: ['bios', 'uefi', 'actualizaci√≥n', 'motherboard'],
      summary: 'Procedimiento paso a paso para actualizar el firmware de la placa base',
      content: `*Pre-requisitos IMPORTANTES:*
      - Energ√≠a estable (UPS recomendado)
      - No interrumpir el proceso bajo ninguna circunstancia
      - Descargar BIOS correcto para modelo exacto de motherboard

      *M√©todos de actualizaci√≥n:*
      
      *1. Desde BIOS con USB:*
      - Formatear USB FAT32
      - Copiar archivo BIOS renombrado seg√∫n instrucciones
      - Usar utility de actualizaci√≥n en BIOS

      *2. Desde Windows (menos seguro):*
      - Usar herramient@ del fabricante (@BIOS, Live Update)
      - Cerrar todas las aplicaciones antes

      *3. Flashback Button (alta gama):*
      - Solo USB, sin CPU/RAM necesarios
      - Bot√≥n dedicado en posterior I/O

      *Razones para actualizar:*
      - Soporte para nuevos CPUs
      - Correcci√≥n de vulnerabilidades
      - Mejora de estabilidad/compatibilidad`
    },
{
      id: 'psu-wattage-calculation',
      title: 'C√°lculo de potencia necesaria para PSU',
      tags: ['psu', 'potencia', 'c√°lculo', 'watts', 'fuente'],
      summary: 'C√≥mo calcular los watts necesarios para tu configuraci√≥n de hardware',
      content: `*Factores a considerar:*
      - CPU TDP (Thermal Design Power)
      - GPU consumo m√°ximo
      - N√∫mero de discos duros/SSD
      - Ventiladores y perif√©ricos
      - Overclocking planeado

      *M√©todos de c√°lculo:*
      
      *1. Calculadoras online:*
      - OuterVision PSU Calculator
      - Newegg PSU Calculator
      - Be Quiet! PSU Calculator

      *2. C√°lculo manual aproximado:*
      - CPU: TDP + 20% para overhead
      - GPU: Consumo m√°ximo seg√∫n especificaciones
      - Base: +100W para motherboard, RAM, almacenamiento
      - Overclocking: +20-30% adicional

      *Ejemplo pr√°ctico:*
      Ryzen 5 5600X (65W) + RTX 3060 (170W)
      = 235W + 100W base = 335W ‚Üí Recomendado 550-650W

      *Margen de seguridad:* Siempre +20-30% sobre c√°lculo te√≥rico`
    },
    {
      id: 'fan-connector-types',
      title: 'Tipos de conectores de ventiladores',
      tags: ['ventiladores', 'conectores', 'pwm', 'control'],
      summary: 'Identificaci√≥n y diferencias entre conectores de ventiladores',
      content: `*Tipos principales de conectores:*

      *1. 3-pin (Voltage Control):*
      - Pin 1: Tierra (GND)
      - Pin 2: +12V (alimentaci√≥n)
      - Pin 3: Tachometer (RPM sensing)
      - Control por variaci√≥n de voltaje

      *2. 4-pin (PWM Control):*
      - Pines 1-3: Iguales a 3-pin
      - Pin 4: PWM signal (control preciso)
      - Mantiene 12V constante, modula pulsos

      *3. Conectores especiales:*
      - *AIO_PUMP:* Para bombas de refrigeraci√≥n l√≠quida
      - *CPU_OPT:* Segundo ventilador de CPU cooler
      - *SYS_FAN:* Ventiladores de chasis

      *Compatibilidades:*
      - 3-pin ‚Üí 4-pin header (funciona sin PWM)
      - 4-pin ‚Üí 3-pin header (funciona a velocidad m√°xima)
      - Usar splitters para m√∫ltiples ventiladores`
    },
    {
      id: 'front-panel-connections',
      title: 'Conexiones del panel frontal',
      tags: ['panel frontal', 'conexiones', 'motherboard', 'cables'],
      summary: 'Gu√≠a para conectar correctamente los cables del panel frontal del chasis',
      content: `*Cables del panel frontal:*

      *Conector de Power Button:*
      - PWR+ y PWR- (polaridad generalmente no importa)
      - Conecta a pins PWR_BTN en motherboard

      *Conector de Reset Button:*
      - RESET+ y RESET-
      - Conecta a pins RESET en motherboard

      *LEDs de actividad:*
      - *HDD LED:* + y - (importa polaridad)
      - *Power LED:* + y - (importa polaridad)

      *USB headers:*
      - *USB 2.0:* 9-pin con un pin bloqueado
      - *USB 3.0:* 19-pin azul
      - *USB-C:* Keyed connector espec√≠fico

      *Audio frontal:*
      - HD Audio: 9-pin (generalmente en esquina inferior izquierda)
      - AC'97: Legacy, menos com√∫n

      *IMPORTANTE:* Consultar manual de la motherboard para pinout exacto`
    },
    {
      id: 'multimeter-basic-usage',
      title: 'Uso b√°sico del mult√≠metro para diagn√≥stico',
      tags: ['mult√≠metro', 'mediciones', 'voltaje', 'continuidad'],
      summary: 'Gu√≠a de uso del mult√≠metro para pruebas b√°sicas de hardware',
      content: `*Configuraciones b√°sicas del mult√≠metro:*

      *1. Voltaje DC (Direct Current):*
      - Para medir fuentes de poder
      - Rango: 20V DC para rails de PC
      - Negro en COM, Rojo en VŒ©mA

      *2. Continuidad:*
      - Para verificar cables y fusibles
      - Emite sonido si hay conexi√≥n
      - √ötil para diagnosticar cables rotos

      *3. Resistencia (Ohms):*
      - Para verificar resistencias y detectar cortos
      - Valor 0Œ© = cortocircuito
      - Valor ‚àûŒ© = circuito abierto

      *Mediciones seguras en PC:*
      - Siempre equipo apagado y desenchufado para resistencia/continuidad
      - Solo medir voltajes con equipo encendido si tienes experiencia
      - Nunca tocar probes con las manos en mediciones de voltaje`
    },
    {
      id: 'grounding-static-prevention',
      title: 'Prevenci√≥n de descargas est√°ticas (ESD)',
      tags: ['est√°tica', 'esd', 'protecci√≥n', 'grounding'],
      summary: 'T√©cnicas para prevenir da√±os por electricidad est√°tica al trabajar con hardware',
      content: `*Riesgos de ESD (ElectroStatic Discharge):*
      - Da√±o invisible a componentes electr√≥nicos
      - Fallas intermitentes dif√≠ciles de diagnosticar
      - Reducci√≥n de vida √∫til de componentes

      *M√©todos de prevenci√≥n:*

      *B√°sico (m√≠nimo indispensable):*
      - Tocar metal del chasis antes de tocar componentes
      - Trabajar en superficie sin alfombras
      - Evitar ropa sint√©tica que genera est√°tica

      *Profesional:*
      - Pulsera antiest√°tica conectada a tierra
      - Alfombrilla conductiva en mesa de trabajo
      - Humedad ambiental controlada (40-60%)

      *Buenas pr√°cticas:*
      - Manipular componentes por los bordes
      - Mantener componentes en bolsas antiest√°ticas
      - Usar zapatos con suela de cuero/no aislantes`
    },
    {
      id: 'boot-priority-order',
      title: 'Configuraci√≥n del orden de arranque',
      tags: ['arranque', 'boot', 'bios', 'uefi', 'prioridad'],
      summary: 'C√≥mo configurar correctamente el orden de dispositivos de arranque',
      content: `*Tipos de dispositivos de arranque:*

      *Dispositivos comunes:*
      - Windows Boot Manager (UEFI)
      - Hard Disk (Legacy)
      - USB Device
      - CD/DVD Drive
      - Network (PXE)

      *Configuraci√≥n en BIOS/UEFI:*
      1. Entrar a BIOS (Del, F2, F12 durante POST)
      2. Buscar secci√≥n "Boot" o "Arranque"
      3. Establecer orden de prioridad
      4. Guardar cambios y salir (F10)

      *Escenarios comunes:*

      *Instalar Windows/Linux:*
      1. USB/DVD como primer dispositivo
      2. Despu√©s de instalaci√≥n: Windows Boot Manager como primero

      *Arranque dual:*
      - Windows Boot Manager primero
      - Usar GRUB para seleccionar SO

      *Problemas frecuentes:*
      - "No boot device found" ‚Üí Revisar orden y conexiones
      - Arranca directamente a Windows sin mostrar GRUB ‚Üí Orden incorrecto`
    },
    {
      id: 'hardware-benchmarking-tools',
      title: 'Herramientas de benchmarking y estr√©s',
      tags: ['benchmark', 'estr√©s', 'rendimiento', 'temperaturas'],
      summary: 'Software para probar estabilidad y rendimiento del hardware',
      content: `*Herramientas por componente:*

      *CPU:*
      - *Cinebench R23:* Rendimiento multi-core y single-core
      - *Prime95:* Prueba de estr√©s m√°xima (cuidado con temperaturas)
      - *AIDA64:* Prueba integral del sistema

      *GPU:*
      - *3DMark:* Benchmark gaming y rendimiento gr√°fico
      - *FurMark:* Prueba de estr√©s intensiva (usar con precauci√≥n)
      - *Heaven Benchmark:* Prueba b√°sica y gratuita

      *RAM:*
      - *MemTest86:* Detecci√≥n de errores (USB booteable)
      - *AIDA64 Memory Benchmark:* Rendimiento y latencias

      *Almacenamiento:*
      - *CrystalDiskMark:* Velocidades de lectura/escritura
      - *AS SSD Benchmark:* Espec√≠fico para SSD

      *Procedimiento de testing:*
      1. Monitorear temperaturas con HWMonitor
      2. Ejecutar benchmarks por 15-30 minutos
      3. Verificar estabilidad y que no hay throttling`
  },
{
      id:'gpu-troubleshoot',
      title:'Diagn√≥stico de problemas en tarjeta gr√°fica',
      tags:['GPU', 'gr√°ficos', 'artefactos', 'drivers', 'temperatura'],
      summary:'Identificaci√≥n y soluci√≥n de fallos en GPU integrada o dedicada',
      content:`*S√≠ntomas de GPU defectuosa:*
      - Artefactos gr√°ficos (puntos, l√≠neas, texturas corruptas)
      - Pantallazos azules relacionados con controladores gr√°ficos
      - Equipo no da video pero enciende
      - Sobrecalentamiento constante

      *Proceso de diagn√≥stico:*
      1. *Controladores:* Usar DDU en modo seguro y reinstalar versi√≥n estable
      2. *Temperaturas:* Monitorear con HWMonitor/MSI Afterburner
      3. *Conexiones:* Verificar cables de alimentaci√≥n PCIe
      4. *Prueba en otro equipo:* Confirmar si la falla persiste

      *Soluciones:*
      - Reflow/reballing (solo t√©cnicos especializados)
      - Reemplazo de pasta t√©rmica y pads
      - Actualizaci√≥n VBIOS (avanzado)`
    },
{
      id:'hdd-health-check',
      title:'Verificaci√≥n de salud en discos duros HDD/SSD',
      tags:['HDD', 'SSD', 'SMART', 'salud', 'diagn√≥stico'],
      summary:'Uso de herramientas para verificar estado de discos duros y s√≥lidos',
      content:`*Herramientas de diagn√≥stico:*

      *Para HDD (mec√°nicos):*
      - *CrystalDiskInfo:* Monitoreo SMART (temperatura, sectores defectuosos)
      - *HDDScan:* Pruebas superficiales y profundas
      - Ruidos anormales (clic, raspado) indican falla mec√°nica inminente

      *Para SSD:*
      - *SSD Life:* Predicci√≥n de vida √∫til basada en TBW
      - *CrystalDiskMark:* Pruebas de velocidad y rendimiento
      - *Herramientas del fabricante:* Samsung Magician, WD Dashboard

      *Par√°metros SMART cr√≠ticos:*
      - Reallocated Sectors Count (sectores reasignados)
      - Current Pending Sector Count (sectores pendientes)
      - Uncorrectable Sector Count (sectores no corregibles)`
    }

        ]
      },
      {
        id: 'storage-networking',
        title: 'Almacenamiento y Redes',
        items: [
          
      {
      id: 'clone-ssd',
      title: 'Clonar un disco a SSD',
      tags: ['clonar', 'ssd', 'migraci√≥n', 'hdd', 'copia'],
      summary: 'Clonar HDD a SSD sin perder datos ni sistema operativo',
      content: `*PRE-CLONACI√ìN - Preparaci√≥n esencial:*
      - Verificar que SSD tiene capacidad mayor a datos USADOS en HDD
      - Realizar backup de datos cr√≠ticos antes de empezar
      - Descargar e instalar software de clonaci√≥n
      - Conectar SSD (SATA interno o via USB con adaptador)

      *HERRAMIENTAS RECOMENDADAS:*
      - *Windows:* Macrium Reflect Free, Clonezilla, AOMEI Backupper
      - *Linux:* dd (avanzado), Clonezilla, GParted
      - *macOS:* Carbon Copy Cloner, SuperDuper!

      *PROCESO MACRIUM REFLECT (Windows):*
      1. Seleccionar disco de origen (HDD actual)
      2. Seleccionar disco destino (SSD nuevo)
      3. *OPCI√ìN CR√çTICA:* "Copy partitions" y marcar "Copy only used sectors"
      4. En "Slide partitions" dejar habilitado para optimizar espacio
      5. Programar clonaci√≥n y reiniciar cuando solicite
      6. *POST-CLONACI√ìN:* Cambiar orden de arranque en BIOS o intercambiar discos f√≠sicamente

      *PROBLEMAS COMUNES:*
      - Error "not enough space" ‚Üí Limpiar archivos temporales o usar SSD m√°s grande
      - No arranca desde SSD ‚Üí Verificar orden de boot en BIOS/UEFI
      - Partici√≥n de recuperaci√≥n no copiada ‚Üí Usar herramienta del fabricante`
    },
    {
      id: 'network-troubleshoot',
      title: 'Resoluci√≥n de problemas de red',
      tags: ['red', 'dhcp', 'dns', 'ping', 'wifi', 'troubleshoot'],
      summary: 'Diagn√≥stico sistem√°tico de problemas de conectividad de red',
      content: `*METODOLOG√çA POR CAPAS OSI:*

      *CAPA 1 - F√≠sica (Cables/Hardware):*
      - Verificar LEDs en router/tarjeta de red
      - Probar diferentes cables Ethernet
      - Reiniciar router y equipo
      - Verificar interruptor WiFi activado

      *CAPA 2 - Enlace de Datos (MAC/Driver):*
      - *Windows:* \ipconfig /all\ ‚Üí Si no muestra adaptador, problema de driver
      - Actualizar drivers de tarjeta de red
      - Verificar si adaptador est√° habilitado en Administrador de dispositivos

      *CAPA 3 - Red (IP/DHCP):*
      - *IP Correcta:* \ipconfig\ ‚Üí Debe ser 192.168.x.x, 10.x.x.x, 172.16.x.x
      - *IP 169.254.x.x:* Fall√≥ DHCP ‚Üí Ejecutar \ipconfig /release\ y \ipconfig /renew\
      - *Ping al Gateway:* \ping 192.168.1.1\ (usar IP de tu router)
      - *Ping a IP p√∫blica:* \ping 8.8.8.8\ ‚Üí Si funciona, problema es DNS

      *CAPA 7 - Aplicaci√≥n (DNS/Navegador):*
      - *Problema DNS:* \ping google.com\ falla pero \ping 8.8.8.8\ funciona
      - Cambiar DNS: 8.8.8.8 (Google) o 1.1.1.1 (Cloudflare)
      - Limpiar cache DNS: \ipconfig /flushdns\

      *HERRAMIENTAS AVANZADAS:*
      - \tracert 8.8.8.8\ ‚Üí Ver donde se pierden paquetes
      - \netsh winsock reset\ ‚Üí Resetear stack de red
      - \nslookup google.com\ ‚Üí Verificar resoluci√≥n DNS`
    },
    {
      id: 'raid-types',
      title: 'Configuraciones RAID',
      tags: ['RAID', 'almacenamiento', 'redundancia', 'rendimiento', 'backup'],
      summary: 'Descripci√≥n detallada de niveles RAID y configuraci√≥n pr√°ctica',
      content: `*CONCEPTOS B√ÅSICOS RAID:*
      - *Striping (Distribuci√≥n):* Mejora rendimiento
      - *Mirroring (Espejo):* Proporciona redundancia
      - *Parity (Paridad):* Balance entre rendimiento y redundancia

      *NIVELES RAID COMUNES:*

      *RAID 0 (Striping):*
      - *Ventaja:* M√°ximo rendimiento (velocidad combinada)
      - *Desventaja:* Cero tolerancia a fallos
      - *M√≠nimo discos:* 2
      - *Capacidad √∫til:* 100% del total
      - *Uso:* Editing video, gaming, donde velocidad > seguridad

      *RAID 1 (Mirroring):*
      - *Ventaja:* Redundancia completa, lectura m√°s r√°pida
      - *Desventaja:* Capacidad √∫til = disco m√°s peque√±o
      - *M√≠nimo discos:* 2
      - *Capacidad √∫til:* 50% del total
      - *Uso:* Servidores cr√≠ticos, almacenamiento importante

      *RAID 5 (Striping con Paridad Distribuida):*
      - *Ventaja:* Rendimiento + redundancia, eficiencia de espacio
      - *Desventaja:* Lento en escrituras, reconstrucci√≥n compleja
      - *M√≠nimo discos:* 3
      - *Capacidad √∫til:* (N-1) discos
      - *Uso:* Servidores de archivos, NAS empresariales

      *RAID 10 (1+0):*
      - *Ventaja:* Alto rendimiento + alta tolerancia a fallos
      - *Desventaja:* Coste elevado (necesita muchos discos)
      - *M√≠nimo discos:* 4
      - *Capacidad √∫til:* 50% del total
      - *Uso:* Bases de datos, entornos cr√≠ticos de alto rendimiento

      *IMPLEMENTACI√ìN:*
      - *Hardware RAID:* Controlador dedicado, mejor rendimiento
      - *Software RAID:* Windows Storage Spaces, Linux mdadm, macOS Disk Utility
      - *Fake RAID:* BIOS RAID, no recomendado`
    },
{
      id: 'ssd-optimization',
      title: 'Optimizaci√≥n y mantenimiento de SSD',
      tags: ['ssd', 'optimizaci√≥n', 'trim', 'rendimiento', 'vida-√∫til'],
      summary: 'Configuraciones para maximizar rendimiento y vida √∫til de SSD',
      content: `*CONFIGURACIONES WINDOWS PARA SSD:*
      - *TRIM:* Verificar activado ‚Üí \fsutil behavior query DisableDeleteNotify\
      - *Desfragmentaci√≥n:* DESACTIVADA para SSD (usar optimizaci√≥n)
      - *Archivo de paginaci√≥n:* Dejar en SSD para rendimiento
      - *Prefetch/Superfetch:* Desactivar o dejar que Windows gestione
      - *Hibernaci√≥n:* Considerar desactivar si no se usa para ahorrar espacio

      *HERRAMIENTAS DE MONITOREO:*
      - *CrystalDiskInfo:* Salud SMART del SSD
      - *SSD Manufacturer Tools:* Samsung Magician, WD Dashboard
      - *TBW (Total Bytes Written):* Monitorear escritura total

      *PR√ÅCTICAS PARA EXTENDER VIDA √öTIL:*
      - Dejar 10-20% de espacio libre
      - Evitar escrituras innecesarias (temp files en RAM disk)
      - No llenar por completo el SSD
      - Actualizar firmware regularmente`
    },
    {
      id: 'hdd-bad-sectors',
      title: 'Reparaci√≥n de sectores defectuosos en HDD',
      tags: ['hdd', 'sectores', 'defectuosos', 'reparaci√≥n', 'chkdsk'],
      summary: 'Detecci√≥n y reparaci√≥n de bad sectors en discos duros mec√°nicos',
      content: `*S√çNTOMAS DE BAD SECTORS:*
      - Ruidos de clic o raspado
      - Archivos que no se abren o se corrompen
      - Sistema operativo muy lento
      - Errores de CRC o I/O device

      *HERRAMIENTAS DE DIAGN√ìSTICO:*
      - *Windows:* CHKDSK ‚Üí \chkdsk C: /f /r /x\
      - *CrystalDiskInfo:* Ver par√°metros SMART (Reallocated Sectors)
      - *HDDScan:* Pruebas superficiales y profundas
      - *Manufacturer Tools:* Herramientas espec√≠ficas del fabricante

      *PROCESO DE REPARACI√ìN:*
      1. *CHKDSK Completo:* Identifica y marca sectores como malos
      2. *Herramientas de bajo nivel:* Solo para usuarios avanzados
      3. *Reasignaci√≥n de sectores:* El firmware del disco lo hace autom√°ticamente

      *DECISIONES CR√çTICAS:*
      - *Pocos bad sectors:* Continuar usando con monitoreo
      - *Aumento constante de bad sectors:* Reemplazar inmediatamente
      - *SMART status "Caution" o "Bad":* Hacer backup y reemplazar`
    },
    {
      id: 'nas-setup-basic',
      title: 'Configuraci√≥n b√°sica de NAS casero',
      tags: ['nas', 'almacenamiento', 'red', 'servidor', 'casero'],
      summary: 'Gu√≠a para implementar almacenamiento en red b√°sico',
      content: `*OPCIONES DE IMPLEMENTACI√ìN NAS:*

      *1. NAS Preensamblado (Synology/QNAP):*
      - Ventaja: F√°cil configuraci√≥n, software incluido
      - Desventaja: Menor flexibilidad, m√°s costoso

      *2. NAS Casero con PC Viejo:*
      - *Software:* TrueNAS, OpenMediaVault, UnRAID
      - *Hardware:* M√≠nimo 4GB RAM, m√∫ltiples bah√≠as HDD
      - *RAID:* Recomendado RAID 1, 5 o 6 para redundancia

      *3. Raspberry Pi NAS:*
      - *Ventaja:* Bajo consumo, silencioso
      - *Limitaci√≥n:* Velocidad USB, solo para uso b√°sico

      *CONFIGURACI√ìN B√ÅSICA:*
      1. Instalar sistema operativo NAS
      2. Configurar RAID seg√∫n necesidades
      3. Crear shares SMB/CIFS (Windows) o NFS (Linux)
      4. Configurar usuarios y permisos
      5. Establecer backups autom√°ticos

      *SERVICIOS ADICIONALES:*
      - Plex Media Server
      - Nextcloud (nube personal)
      - Time Machine backups (macOS)`
    },
{
      id: 'external-hdd-troubleshoot',
      title: 'Diagn√≥stico de discos duros externos',
      tags: ['externo', 'hdd', 'usb', 'diagn√≥stico', 'reparaci√≥n'],
      summary: 'Soluci√≥n de problemas comunes en discos externos y USB',
      content: `*PROBLEMAS COMUNES Y SOLUCIONES:*

      *1. No es reconocido por la computadora:*
      - Probar en otro puerto USB
      - Probar en otra computadora
      - Verificar si necesita alimentaci√≥n externa
      - Escuchar si el disco gira (sonido mec√°nico)

      *2. Reconocido pero no muestra datos:*
      - Verificar en Administraci√≥n de discos (Windows)
      - Verificar en Disk Utility (macOS)
      - Probar con \lsblk\ o \fdisk -l\ (Linux)

      *3. Error "Device not recognized" o "Unknown Device":*
      - Actualizar drivers USB
      - Probar cable USB diferente
      - Verificar si el puerto USB proporciona suficiente energ√≠a

      *4. Disco hace clic repetitivo:*
      - Falla mec√°nica grave
      - Apagar inmediatamente
      - Considerar recuperaci√≥n profesional si datos son cr√≠ticos

      *HERRAMIENTAS ESPEC√çFICAS:*
      - *USBDeview:* Ver todos dispositivos USB conectados
      - *ChipGenius:* Identificar controlador USB de discos externos`
    },
    {
      id: 'partition-management',
      title: 'Gesti√≥n avanzada de particiones',
      tags: ['particiones', 'gesti√≥n', 'gparted', 'disk-management'],
      summary: 'Operaciones avanzadas con particiones y sistemas de archivos',
      content: `*HERRAMIENTAS DE PARTICIONADO:*

      *Windows:*
      - *Disk Management:* Herramienta nativa b√°sica
      - *MiniTool Partition Wizard:* Caracter√≠sticas avanzadas gratis
      - *AOMEI Partition Assistant:* Alternativa completa

      *Linux:*
      - *GParted:* Est√°ndar de la industria (GUI)
      - *fdisk/parted:* Herramientas de l√≠nea de comandos
      - *GNOME Disks:* Utilidad gr√°fica integrada

      *macOS:*
      - *Disk Utility:* Herramienta nativa
      - *iPartition:* Alternativa de pago con m√°s funciones

      *OPERACIONES AVANZADAS:*
      - *Redimensionar particiones:* Mover inicio/fin sin perder datos
      - *Convertir MBR a GPT:* Para discos >2TB y UEFI
      - *Alinear particiones SSD:* Optimizar para SSD
      - *Recuperar particiones eliminadas:* TestDisk, PhotoRec

      *SISTEMAS DE ARCHIVOS COMUNES:*
      - *NTFS:* Windows (compatible lectura macOS/Linux)
      - *APFS:* macOS (optimizado para SSD)
      - *ext4:* Linux (est√°ndar)
      - *exFAT:* Compatibilidad multiplataforma`
    },
    {
      id: 'backup-strategies',
      title: 'Estrategias de backup efectivas',
      tags: ['backup', 'copia-seguridad', 'estrategia', 'recuperaci√≥n'],
      summary: 'Planificaci√≥n e implementaci√≥n de estrategias de backup robustas',
      content: `*REGLA 3-2-1 DEL BACKUP:*
      - *3* copias de tus datos
      - *2* medios de almacenamiento diferentes
      - *1* copia fuera del sitio (off-site)

      *TIPOS DE BACKUP:*

      *1. Completo (Full):*
      - Copia todos los datos seleccionados
      - Lento, requiere mucho espacio
      - M√°s f√°cil recuperaci√≥n

      *2. Incremental:*
      - Copia solo lo cambiado desde √∫ltimo backup
      - R√°pido, menos espacio
      - Recuperaci√≥n m√°s lenta (necesita cadena completa)

      *3. Diferencial:*
      - Copia lo cambiado desde √∫ltimo backup completo
      - Balance entre espacio y velocidad de recuperaci√≥n

      *HERRAMIENTAS RECOMENDADAS:*
      - *Windows:* Veeam Agent, Macrium Reflect, Windows Backup
      - *macOS:* Time Machine, Carbon Copy Cloner
      - *Linux:* rsync, Timeshift, Deja Dup

      *AUTOMATIZACI√ìN:*
      - Programar backups regulares
      - Verificar integridad de backups
      - Pruebas de recuperaci√≥n peri√≥dicas`
    },
{
      id: 'wifi-optimization',
      title: 'Optimizaci√≥n de red WiFi',
      tags: ['wifi', 'optimizaci√≥n', 'router', 'canales', 'se√±al'],
      summary: 'Mejora de cobertura y rendimiento de redes inal√°mbricas',
      content: `*FACTORES QUE AFECTAN SE√ëAL WiFi:*

      *Interferencias:*
      - Otros routers WiFi en canales cercanos
      - Dispositivos Bluetooth, microondas
      - Espejos, paredes gruesas, muebles met√°licos

      *OPTIMIZACI√ìN B√ÅSICA:*
      1. *Elegir canal correcto:* Usar WiFi Analyzer para ver canales menos usados
      2. *Posici√≥n del router:* Central, elevado, sin obstrucciones
      3. *Actualizar firmware:* Router y adaptadores WiFi
      4. *Bandas:* Usar 5GHz para velocidad, 2.4GHz para alcance

      *MEJORAS AVANZADAS:*
      - *Access Points adicionales:* Extender cobertura
      - *Sistemas Mesh:* Soluci√≥n profesional para casas grandes
      - *Antenas direccionales:* Para enlaces punto a punto
      - *Powerline adapters:* Usar cableado el√©ctrico como extensi√≥n

      *HERRAMIENTAS DE DIAGN√ìSTICO:*
      - *WiFi Analyzer (Android/Windows):* An√°lisis de canales y se√±al
      - *NetSpot:* Mapeo de cobertura profesional
      - *speedtest.net:* Velocidad real de internet`
    },
    {
      id: 'vpn-setup-home',
      title: 'Configuraci√≥n de VPN casera',
      tags: ['vpn', 'seguridad', 'red', 'openvpn', 'wireguard'],
      summary: 'Implementaci√≥n de VPN para acceso remoto seguro',
      content: `*TIPOS DE VPN CASERAS:*

      *1. VPN de Acceso Remoto:*
      - Conectarte a tu red dom√©stica desde fuera
      - Acceso seguro a NAS, c√°maras IP, otros dispositivos

      *2. VPN Comercial:*
      - Encriptar todo tu tr√°fico para privacidad
      - Acceder a contenido georestringido

      *IMPLEMENTACI√ìN VPN CASERA:*

      *Opci√≥n 1 - Router con soporte VPN:*
      - Configurar OpenVPN/WireGuard en router compatible
      - M√°s simple, siempre disponible

      *Opci√≥n 2 - Raspberry Pi/VPS:*
      - *OpenVPN:* Est√°ndar de la industria, amplia compatibilidad
      - *WireGuard:* Moderno, m√°s r√°pido, menos configuraci√≥n
      - *Tailscale:* F√°cil configuraci√≥n, ideal para beginners

      *PASOS B√ÅSICOS OPENVPN:*
      1. Instalar OpenVPN en servidor (Pi o VPS)
      2. Generar certificados y configuraciones
      3. Configurar port forwarding en router (puerto 1194)
      4. Instalar cliente OpenVPN en dispositivos m√≥viles/PC

      *SEGURIDAD:*
      - Usar autenticaci√≥n por certificados, no solo usuario/contrase√±a
      - Mantener software actualizado
      - Usar puertos no est√°ndar para evitar scans autom√°ticos`
    },
    {
      id: 'port-forwarding',
      title: 'Configuraci√≥n de Port Forwarding',
      tags: ['port-forwarding', 'router', 'nat', 'servidores'],
      summary: 'Gu√≠a para redireccionar puertos en el router',
      content: `*QU√â ES PORT FORWARDING:*
      - Redirige tr√°fico de internet a un dispositivo espec√≠fico en tu red local
      - Necesario para servidores web, juegos, VPN, acceso remoto

      *PROCESO B√ÅSICO:*
      1. *IP est√°tica local:* Asignar IP fija al dispositivo destino
      2. *Acceder al router:* Normalmente 192.168.1.1 o 192.168.0.1
      3. *Encontrar secci√≥n:* "Port Forwarding", "NAT", "Virtual Servers"
      4. *Configurar regla:*
         - Puerto externo: Lo que recibe el router desde internet
         - Puerto interno: Puerto del servicio en el dispositivo local
         - Protocolo: TCP, UDP o ambos
         - IP destino: IP est√°tica del dispositivo local

      *EJEMPLOS COMUNES:*
      - *Minecraft Server:* TCP 25565
      - *Web Server:* TCP 80 (HTTP) y 443 (HTTPS)
      - *VPN:* UDP 1194 (OpenVPN)
      - *Remote Desktop:* TCP 3389

      *SEGURIDAD:*
      - Solo abrir puertos necesarios
      - Mantener software actualizado
      - Considerar VPN en lugar de port forwarding directo`
    },
    {
      id: 'dns-configuration',
      title: 'Configuraci√≥n y optimizaci√≥n de DNS',
      tags: ['dns', 'resoluci√≥n', 'optimizaci√≥n', 'servidores'],
      summary: 'Optimizaci√≥n de servidores DNS para mejor rendimiento y seguridad',
      content: `*QU√â HACE EL DNS:*
      - Convierte nombres de dominio (google.com) en direcciones IP (172.217.0.0)
      - Primera l√≠nea de defensa contra malware y phishing

      *SERVIDORES DNS RECOMENDADOS:*

      *Rendimiento:*
      - *Cloudflare:* 1.1.1.1 y 1.0.0.1 ‚Üí Generalmente m√°s r√°pido
      - *Google:* 8.8.8.8 y 8.8.4.4 ‚Üí Buena infraestructura global
      - *Quad9:* 9.9.9.9 ‚Üí Enfocado en seguridad

      *Caracter√≠sticas especiales:*
      - *OpenDNS:* 208.67.222.222 ‚Üí Filtrado de contenido familiar
      - *AdGuard DNS:* 94.140.14.14 ‚Üí Bloqueo de anuncios a nivel DNS

      *C√ìMO CONFIGURAR:*

      *En Router (recomendado):*
      - Afecta a todos los dispositivos de la red
      - Configurar en administraci√≥n del router

      *En Windows:*
      - Network Connections ‚Üí Adaptador ‚Üí Properties ‚Üí TCP/IPv4

      *En Linux:*
      - Editar /etc/resolv.conf o usar systemd-resolved

      *HERRAMIENTAS DE TEST:*
      - \nslookup google.com\ ‚Üí Ver servidor DNS usado
      - \dnslookup-performance.tools\ ‚Üí Comparar velocidad de diferentes DNS`
    },
    {
      id: 'network-monitoring',
      title: 'Monitoreo de red y ancho de banda',
      tags: ['monitoreo', 'ancho-de-banda', 'tr√°fico', 'herramientas'],
      summary: 'Herramientas para monitorear uso de red y diagnosticar problemas',
      content: `*HERRAMIENTAS DE MONITOREO:*

      *Uso en Tiempo Real:*
      - *Windows:* Task Manager ‚Üí Performance ‚Üí Ethernet/WiFi
      - *Linux:* \nload\, \iftop\, \bmon\
      - *Multiplataforma:* NetWorx, BitMeter

      *An√°lisis de Tr√°fico:*
      - *Wireshark:* An√°lisis profundo de paquetes (avanzado)
      - *GlassWire:* Monitorizaci√≥n visual y detecci√≥n de amenazas
      - *PRTG Network Monitor:* Soluci√≥n empresarial gratuita para uso personal

      *Monitoreo de Ancho de Banda por Dispositivo:*
      - *Router con firmware avanzado:* OpenWrt, DD-WRT
      - *ntopng:* Herramienta profesional de an√°lisis de tr√°fico

      *DETECCI√ìN DE PROBLEMAS:*
      - *Uso alto constante:* Backup en la nube, streaming, updates
      - *Picos inesperados:* Malware, dispositivos no autorizados
      - *Latencia alta:* Congesti√≥n de red, problemas de ISP

      *OPTIMIZACI√ìN:*
      - Programar backups y updates para horas de poco uso
      - Usar QoS en router para priorizar tr√°fico cr√≠tico
      - Identificar y limitar aplicaciones que consumen mucho ancho de banda`
    },
    {
      id: 'static-ip-configuration',
      title: 'Configuraci√≥n de IP est√°tica',
      tags: ['ip', 'est√°tica', 'configuraci√≥n', 'red-local'],
      summary: 'Asignaci√≥n de direcciones IP fijas en red local',
      content: `*CU√ÅNDO USAR IP EST√ÅTICA:*
      - Servidores (web, NAS, impresoras)
      - Port forwarding
      - Acceso remoto consistente
      - Dispositivos de red cr√≠ticos

      *M√âTODOS DE CONFIGURACI√ìN:*

      *1. Reserva DHCP en Router (Recomendado):*
      - El router asigna siempre la misma IP al dispositivo por MAC address
      - Ventaja: Centralizado, f√°cil gesti√≥n
      - Configurar en administraci√≥n del router

      *2. IP Est√°tica en Dispositivo:*
      - Configurar manualmente en adaptador de red
      - *Windows:* Network Connections ‚Üí Properties ‚Üí TCP/IPv4
      - *Linux:* nmtui o editar /etc/netplan/
      - *macOS:* System Preferences ‚Üí Network ‚Üí Advanced ‚Üí TCP/IP

      *CONFIGURACI√ìN CORRECTA:*
      - *IP:* Mismo rango que red (ej: 192.168.1.50)
      - *M√°scara:* Normalmente 255.255.255.0
      - *Gateway:* IP del router (ej: 192.168.1.1)
      - *DNS:* Router o servidores p√∫blicos (8.8.8.8, 1.1.1.1)

      *EVITAR CONFLICTOS:*
      - Usar IPs fuera del rango DHCP del router
      - Documentar todas las IPs est√°ticas asignadas`
    },
    {
      id: 'network-security-basic',
      title: 'Seguridad b√°sica de red dom√©stica',
      tags: ['seguridad', 'red', 'wifi', 'router', 'firewall'],
      summary: 'Protecci√≥n esencial para red dom√©stica contra amenazas comunes',
      content: `*CONFIGURACIONES DE SEGURIDAD ESENCIALES:*

      *Router:*
      1. *Cambiar contrase√±a admin:* No dejar credenciales por defecto
      2. *Actualizar firmware:* Parchear vulnerabilidades conocidas
      3. *WPA2/WPA3:* Nunca WEP o WPA original
      4. *Contrase√±a WiFi fuerte:* M√≠nimo 12 caracteres, mezcla de tipos
      5. *Deshabilitar WPS:* Vulnerable a ataques de fuerza bruta
      6. *Firewall habilitado:* Generalmente activado por defecto

      *WiFi:*
      1. *SSID no identificable:* No usar direcci√≥n o nombres personales
      2. *Ocultar SSID (opcional):* Seguridad por oscuridad, no muy efectiva
      3. *Filtrado MAC:* Solo dispositivos autorizados pueden conectarse
      4. *Guest network:* Para visitas, aislada de red principal

      *Dispositivos:*
      1. *Firewall activado:* Windows Firewall o equivalente
      2. *Actualizaciones autom√°ticas:* SO y aplicaciones
      3. *Antivirus:* Esencial en Windows, recomendado en otros SO

      *HERRAMIENTAS DE VERIFICACI√ìN:*
      - *ShieldsUP!:* Escanear puertos abiertos hacia internet
      - *F-Secure Router Checker:* Verificar configuraci√≥n de seguridad`
    },
    {
      id: 'qos-configuration',
      title: 'Configuraci√≥n de Calidad de Servicio (QoS)',
      tags: ['qos', 'calidad-servicio', 'prioridad', 'ancho-banda'],
      summary: 'Optimizaci√≥n del tr√°fico de red para priorizar aplicaciones cr√≠ticas',
      content: `*QU√â ES QoS:*
      - Controla c√≥mo el router prioriza diferentes tipos de tr√°fico
      - Evita que una descarga grande afecte llamadas VoIP o gaming

      *TIPOS DE QoS:*

      *1. Basado en Dispositivo:*
      - Priorizar tr√°fico de dispositivos espec√≠ficos (consola, tel√©fono trabajo)
      - √ötil cuando sabes qu√© dispositivos son cr√≠ticos

      *2. Basado en Aplicaci√≥n:*
      - Priorizar tipos de tr√°fico (VoIP, gaming, video streaming)
      - M√°s inteligente, se adapta al uso real

      *CONFIGURACI√ìN T√çPICA:*

      *Aplicaciones ALTA prioridad:*
      - Llamadas VoIP (Skype, Zoom)
      - Juegos online
      - Video conferencias

      *Aplicaciones MEDIA prioridad:*
      - Video streaming (YouTube, Netflix)
      - Navegaci√≥n web

      *Aplicaciones BAJA prioridad:*
      - Descargas grandes
      - Updates de software
      - Backup en la nube

      *IMPLEMENTACI√ìN:*
      - Activar en administraci√≥n del router
      - Establecer l√≠mites de ancho de banda si es necesario
      - Monitorizar y ajustar seg√∫n resultados`
    },
{
      id: 'mesh-vs-extender',
      title: 'Sistemas Mesh vs Extensores WiFi',
      tags: ['mesh', 'extender', 'wifi', 'cobertura', 'rendimiento'],
      summary: 'Comparaci√≥n y selecci√≥n entre sistemas Mesh y extensores tradicionales',
      content: `*EXTENSORES WIFI TRADICIONALES:*

      *Ventajas:*
      - M√°s econ√≥micos
      - F√°ciles de instalar
      - Compatibles con cualquier router

      *Desventajas:*
      - Crean red separada (normalmente)
      - P√©rdida de velocidad significativa
      - Gesti√≥n separada del router principal

      *SISTEMAS MESH:*

      *Ventajas:*
      - Red unificada (mismo SSID)
      - Handoff autom√°tico entre nodos
      - Mejor gesti√≥n centralizada
      - Generalmente mejor rendimiento

      *Desventajas:*
      - M√°s costosos
      - Normalmente requieren reemplazar router existente

      *CU√ÅNDO ELEGIR CADA UNO:*

      *Extensor:*
      - Presupuesto limitado
      - Necesidad puntual de cobertura en √°rea peque√±a
      - Router actual funciona bien y no quieres cambiarlo

      *Mesh:*
      - Casa grande o m√∫ltiples pisos
      - M√∫ltiples usuarios y dispositivos
      - Necesidad de roaming sin interrupciones
      - Presupuesto disponible para mejor soluci√≥n

      *RECOMENDACIONES:*
      - *Extensores buenos:* TP-Link RE series, Netgear EX series
      - *Mesh econ√≥micos:* TP-Link Deco, Google Nest WiFi
      - *Mesh profesionales:* Ubiquiti AmpliFi, ASUS ZenWiFi`
    },
    {
      id: 'internet-speed-troubleshoot',
      title: 'Diagn√≥stico de problemas de velocidad de internet',
      tags: ['velocidad', 'internet', 'diagn√≥stico', 'isp', 'lentitud'],
      summary: 'Metodolog√≠a para identificar y resolver problemas de velocidad',
      content: `*PRUEBAS INICIALES:*
      1. *Speedtest:* speedtest.net o fast.com
      2. *Velocidad contratada vs obtenida:* Considerar 80-90% como normal por overhead
      3. *Comparar cable vs WiFi:* Identificar si problema es inal√°mbrico

      *PROBLEMAS COMUNES Y SOLUCIONES:*

      *Velocidad baja por WiFi:*
      - Cambiar canal WiFi (usar analyzer)
      - Acercarse al router o mejorar posici√≥n
      - Actualizar drivers adaptador WiFi
      - Cambiar a banda 5GHz si est√° disponible

      *Velocidad baja por cable:*
      - Probar diferentes cables Ethernet
      - Verificar negociaci√≥n de velocidad (debe ser 1Gbps)
      - Actualizar drivers tarjeta de red

      *Velocidad baja en todos los dispositivos:*
      - Reiniciar router y m√≥dem
      - Probar directamente conectado al m√≥dem (bypass router)
      - Contactar ISP: Puede haber problema en l√≠nea

      *HERRAMIENTAS AVANZADAS:*
      - *PingPlotter:* Monitoreo continuo de latencia y packet loss
      - *Router stats:* Ver SNR margin y l√≠nea quality en administraci√≥n
      - *Traceroute:* Identificar donde ocurren cuellos de botella

      *CU√ÅNDO CONTACTAR ISP:*
      - Velocidad consistentemente <80% de lo contratado
      - Alta packet loss (>1-2%)
      - Latencia muy variable
      - Problemas a horas espec√≠ficas (congesti√≥n de √°rea)`
    },
    {
      id: 'network-protocols-explained',
      title: 'Protocolos de red explicados',
      tags: ['protocolos', 'tcp', 'udp', 'http', 'ftp'],
      summary: 'Descripci√≥n de protocolos de red comunes y sus usos',
      content: `*PROTOCOLOS FUNDAMENTALES:*

      *TCP (Transmission Control Protocol):*
      - *Conexi√≥n orientada:* Handshake antes de transmitir
      - *Fiabilidad:* Retransmite paquetes perdidos, entrega en orden
      - *Overhead:* M√°s lento pero confiable
      - *Usos:* Web (HTTP/S), email, transferencia de archivos

      *UDP (User Datagram Protocol):*
      - *Sin conexi√≥n:* Env√≠a datos sin handshake
      - *No fiable:* Sin retransmisi√≥n, puede llegar desordenado
      - *Bajo overhead:* M√°s r√°pido para tiempo real
      - *Usos:* Video streaming, VoIP, gaming online, DNS

      *PROTOCOLOS DE APLICACI√ìN:*

      *HTTP/HTTPS (Web):*
      - HTTP: No encriptado
      - HTTPS: Encriptado con SSL/TLS

      *FTP/SFTP (Transferencia archivos):*
      - FTP: No seguro
      - SFTP: Seguro sobre SSH

      *SSH (Secure Shell):*
      - Conexi√≥n segura remota a servidores

      *DNS (Domain Name System):*
      - Resoluci√≥n nombres dominio a IP

      *DHCP (Dynamic Host Configuration):*
      - Asignaci√≥n autom√°tica de IPs en red local

      *PUERTOS COMUNES:*
      - 80: HTTP | 443: HTTPS | 22: SSH | 53: DNS
      - 25: SMTP | 110: POP3 | 143: IMAP
      - 25565: Minecraft | 27015: Steam`
    },       
        
        ]
      },
      {
        id: 'os-maintenance',
        title: 'Sistemas Operativos',
        items: [
{ id:'win-install', title:'Instalar Windows 10/11 desde USB', tags:['windows','instalaci√≥n'], summary:'Creaci√≥n de USB booteable y consideraciones UEFI', content:`*PRE-INSTALACI√ìN - PREPARACI√ìN ESENCIAL:*
      
      *1. Backup de Datos:*
      - Documentos, fotos, videos, descargas
      - Favoritos del navegador, contrase√±as guardadas
      - Licencias de software, claves de producto
      - Configuraciones de aplicaciones importantes

      *2. Herramientas Necesarias:*
      - USB de 8GB+ para crear medio de instalaci√≥n
      - Herramienta Media Creation Tool de Microsoft
      - Drivers actualizados (especialmente red y chipset)
      - Software esencial post-instalaci√≥n listo para instalar

      *PROCESO DE INSTALACI√ìN DETALLADO:*

      *Paso 1 - Crear USB Booteable:*
      - Descargar Media Creation Tool desde Microsoft
      - Ejecutar como administrador, seleccionar "Crear medio de instalaci√≥n"
      - Elegir idioma, edici√≥n y arquitectura (64-bit recomendado)
      - Seleccionar USB flash drive y esperar a que se cree

      *Paso 2 - Configurar BIOS/UEFI:*
      - Reiniciar y entrar a BIOS (F2, Del, F12 seg√∫n motherboard)
      - Deshabilitar Secure Boot temporalmente
      - Habilitar arranque desde USB como primera opci√≥n
      - Guardar cambios y reiniciar

      *Paso 3 - Instalaci√≥n Windows:*
      - Presionar cualquier tecla cuando aparezca "Press any key to boot from USB"
      - Seleccionar idioma, formato hora y teclado
      - Hacer clic en "Instalar ahora"
      - Introducir clave de producto o elegir "No tengo clave de producto"
      - Seleccionar edici√≥n de Windows (Home/Pro)
      - Aceptar t√©rminos de licencia

      *Paso 4 - Particionado Avanzado:*
      - En "Tipo de instalaci√≥n" elegir "Personalizada"
      - *ELIMINAR TODAS LAS PARTICIONES* hasta que quede "Espacio no asignado"
      - Seleccionar espacio no asignado y hacer clic en "Siguiente"
      - Windows crear√° autom√°ticamente particiones necesarias (EFI, MSR, Primaria)

      *POST-INSTALACI√ìN - CONFIGURACI√ìN ESENCIAL:*
      1. *Actualizaciones Windows:* Instalar todas las actualizaciones disponibles
      2. *Controladores:* Instalar chipset, audio, red, gr√°ficos desde fabricante
      3. *Windows Settings:* Configurar privacidad, energ√≠a, rendimiento
      4. *Software Essential:* Navegador, office, antivirus, utilidades

      *PROBLEMAS COMUNES Y SOLUCIONES:*
      - "No se encontraron controladores": Usar USB 2.0 o cambiar puertos
      - Error de instalaci√≥n: Verificar integridad del ISO/USB
      - No reconoce SSD NVMe: Habilitar RAID/AHCI en BIOS`
    },
          { id:'linux-basics', title:'Instalaci√≥n b√°sica de Linux', tags:['linux','grub'], summary:'Tareas post-instalaci√≥n esenciales', content:`*PROBLEMAS COMUNES DE ARRANQUE LINUX:*

*1. Windows sobrescribe GRUB:*
- S√≠ntoma: Arranca directamente a Windows sin mostrar GRUB
- Soluci√≥n: Reparar GRUB desde Live USB

*2. GRUB Rescue Prompt:*
- S√≠ntoma: Aparece consola grub rescue
- Causa: Partici√≥n de arranque no encontrada o corrupta

*3. Error: "No such device" o "Unknown filesystem"*
- Causa: UUID cambiado o particiones modificadas

*PROCEDIMIENTO DE RECUPERACI√ìN GRUB:*

*Desde Live USB (M√©todo Est√°ndar):*
1. Bootear desde Live USB de tu distribuci√≥n
2. Abrir terminal y identificar particiones:
\\\`bash
sudo fdisk -l
\\\`
3. Montar partici√≥n ra√≠z:
\\\`bash
sudo mount /dev/sdXY /mnt
\\\`
4. Montar sistemas especiales:
\\\`bash
sudo mount --bind /dev /mnt/dev
sudo mount --bind /dev/pts /mnt/dev/pts
sudo mount --bind /proc /mnt/proc
sudo mount --bind /sys /mnt/sys
\\\`
5. Chroot:
\\\`bash
sudo chroot /mnt
\\\`
6. Reinstalar GRUB:
\\\`bash
grub-install /dev/sdX
\\\`
7. Actualizar configuraci√≥n:
\\\`bash
update-grub
\\\`
8. Salir y reiniciar

*UEFI SPECIFIC:*
- Verificar modo UEFI/BIOS
- Ver entradas UEFI:
\\\`bash
efibootmgr -v
\\\`

*HERRAMIENTAS ALTERNATIVAS:*
- Boot-Repair
- Super GRUB2 Disk
- GRUB Customizer

*PREVENCI√ìN:*
- Instalar Linux despu√©s de Windows
- Crear partici√≥n /boot separada
- Backup de configuraci√≥n GRUB`
 },

]
      }

    ];

/* =========================
   Knowledge (conceptos sueltos)
   ========================= */
const KNOW_KEY = 'yiyi_knowledge_v1';

let knowledge = [

{
  id:"que-es-ram",
  title:"¬øQu√© es la RAM?",
  tags:["ram","memoria ram","memoria volatil","ddr","modulos"],
  content:`
La RAM (Random Access Memory) es una memoria vol√°til donde se almacenan datos temporales.
Sirve para que el sistema operativo y los programas accedan a informaci√≥n r√°pidamente.

Caracter√≠sticas:
- Tipos: DDR3, DDR4, DDR5
- Es vol√°til: si se apaga el equipo, se borra
- Afecta directamente el rendimiento del sistema
  `
},

{
  id:"tipos-ram",
  title:"Tipos de memoria RAM",
  tags:["ddr","ddr2","ddr3","ddr4","ddr5","memoria"],
  content:`
Tipos de RAM de uso com√∫n:
- DDR2: Obsoleta, 533-800 MHz
- DDR3: 1066-1866 MHz
- DDR4: 2133-3200+ MHz
- DDR5: 4800-6400+ MHz

Diferencias clave:
- Voltaje
- Frecuencia
- Cantidad de pines
- Compatibilidad con motherboard
  `
},

{
  id:"que-es-rom",
  title:"¬øQu√© es la ROM?",
  tags:["rom","memoria rom","bios","uefi"],
  content:`
La ROM (Read Only Memory) es memoria no vol√°til.
Contiene firmware del sistema como la BIOS/UEFI.
Es esencial para el arranque del equipo.
  `
},

{
  id:"chipset",
  title:"¬øQu√© es el chipset?",
  tags:["chipset","placa madre","motherboard","northbridge","southbridge"],
  content:`
El chipset controla la comunicaci√≥n entre CPU, RAM, GPU, almacenamiento y puertos.
Define:
- Compatibilidad de procesadores
- Tipo de RAM soportada
- Cantidad de l√≠neas PCIe
- Conectividad (USB, SATA, NVMe)
  `
},

{
  id:"bios-def",
  title:"¬øQu√© es la BIOS?",
  tags:["bios","uefi","firmware","arranque","post"],
  content:`
La BIOS (Basic Input/Output System) es el firmware base que inicializa el hardware.
Funciones:
- POST (Power-On Self Test)
- Configuraci√≥n de hardware
- Orden de arranque
- Control b√°sico del sistema
  `
},

{
  id:"uefi",
  title:"¬øQu√© es UEFI?",
  tags:["uefi","bios moderna","gpt","secure boot"],
  content:`
UEFI es la versi√≥n moderna de la BIOS.
Ventajas:
- Soporte para discos de m√°s de 2 TB
- Interfaz gr√°fica
- Secure Boot
- Arranque m√°s r√°pido
- Compatibilidad con GPT
  `
},

{
  id:"gpt-vs-mbr",
  title:"Diferencias entre GPT y MBR",
  tags:["gpt","mbr","particiones","uefi","bios"],
  content:`
GPT:
- Hasta 128 particiones
- Requiere UEFI
- M√°s seguro y moderno

MBR:
- M√°x. 4 particiones primarias
- Compatible con BIOS tradicional
- Hasta 2 TB por disco

Hoy se usa GPT como est√°ndar.
  `
},

{
  id:"tipos-disco",
  title:"Tipos de almacenamiento",
  tags:["hdd","ssd","nvme","sata","disco duro","almacenamiento"],
  content:`
Tipos:
1. **HDD** ‚Äì Mecanico, barato, lento
2. **SSD SATA** ‚Äì R√°pido, econ√≥mico
3. **SSD NVMe** ‚Äì Muy r√°pido, PCIe
4. **M.2 SATA** ‚Äì Forma M.2 pero velocidad SATA

Comparaci√≥n aproximada:
- HDD: 80‚Äì150 MB/s
- SSD SATA: 500 MB/s
- NVMe PCIe 3.0: 1500‚Äì3500 MB/s
- NVMe PCIe 4.0: 5000‚Äì7000 MB/s
  `
},

{
  id:"tipos-fuentes",
  title:"Tipos de fuentes de poder",
  tags:["psu","fuente","80 plus","corriente","energia"],
  content:`
Una PSU convierte la corriente AC en DC.

Certificaciones:
- 80 Plus White
- 80 Plus Bronze
- 80 Plus Silver
- 80 Plus Gold
- 80 Plus Platinum

Formato:
- ATX
- SFX
- Flex ATX

Se recomienda usar m√≠nimo 80 Plus Bronze.
  `
},

{
  id:"fuente-watts",
  title:"Cu√°ntos watts necesita una PC",
  tags:["psu","watts","consumo","energia"],
  content:`
Reglas generales:
- Oficinas: 250‚Äì350 W
- PCs gaming mid-range: 550‚Äì650 W
- Gaming alta gama: 750‚Äì850 W
- Estaciones de trabajo: 850‚Äì1200 W

Siempre dejar 25‚Äì30% de margen.
  `
},

{
  id:"gpu",
  title:"¬øQu√© es una GPU?",
  tags:["gpu","tarjeta grafica","video","nvidia","amd"],
  content:`
La GPU procesa gr√°ficos, juegos, video y aceleraci√≥n de IA.

Tipos:
- Integrada: usa la RAM del sistema
- Dedicada: memoria VRAM propia

Usos modernos:
- Juegos
- Edici√≥n
- IA
- Machine Learning
- Dise√±o 3D
  `
},

{
  id:"cpu",
  title:"¬øQu√© es el procesador (CPU)?",
  tags:["cpu","procesador","nucleos","threads"],
  content:`
La CPU ejecuta instrucciones y coordina todo el sistema.

Conceptos clave:
- N√∫cleos
- Hilos (threads)
- Frecuencia (GHz)
- Cach√© L1/L2/L3

Fabricantes principales:
- Intel
- AMD
  `
},

{
  id:"tipos-cpu",
  title:"Tipos de procesadores actuales",
  tags:["cpu","intel","amd","ryzen","core"],
  content:`
AMD Ryzen:
- Series 3000, 5000, 7000

Intel Core:
- 10th ‚Üí 14th gen

Diferencias:
- Arquitectura
- N√∫cleos/hilos
- Eficiencia
- Soporte para DDR4/DDR5
  `
},

{
  id:"vrm",
  title:"¬øQu√© es un VRM?",
  tags:["vrm","motherboard","energia","cpu"],
  content:`
El VRM (Voltage Regulator Module) regula el voltaje del CPU.

Importancia:
- Estabilidad
- Overclock
- Durabilidad
- Rendimiento bajo carga
  `
},

{
  id:"post-codes",
  title:"C√≥digos POST y beeps",
  tags:["post","beeps","motherboard","errores","diagnostico"],
  content:`
Significados comunes:
- 1 beep: Arranque normal
- Repetidos: RAM defectuosa
- 3 largos: Falla de GPU
- Pitidos continuos: CPU o motherboard

Cada fabricante puede variar.
  `
},

{
  id:"sistema-operativo",
  title:"¬øQu√© es un sistema operativo?",
  tags:["os","windows","linux","sistema operativo"],
  content:`
El sistema operativo gestiona recursos del hardware y comunica usuario ‚Üî m√°quina.

Ejemplos:
- Windows 10/11
- Linux (Ubuntu, Mint, Debian)
- macOS
  `
},

{
  id:"drivers",
  title:"¬øQu√© son los drivers?",
  tags:["drivers","controladores","software"],
  content:`
Los drivers permiten que el hardware funcione correctamente.

Tipos:
- GPU
- Audio
- Red
- Chipset
- USB

Siempre mantenerlos actualizados.
  `
},

{
  id:"overheating",
  title:"Causas del sobrecalentamiento",
  tags:["calentamiento","temperaturas","overheat"],
  content:`
Causas comunes:
- Pasta t√©rmica seca
- Polvo acumulado
- Mala ventilaci√≥n
- Fan curve incorrecto
- Fuente inestable
  `
},

{
  id:"pasta-termica",
  title:"¬øQu√© es la pasta t√©rmica?",
  tags:["pasta termica","cooler","cpu","temperaturas"],
  content:`
Es un compuesto que mejora la transferencia de calor entre CPU y disipador.
Debe cambiarse cada 1‚Äì2 a√±os.
  `
},

{
  id:"ip",
  title:"¬øQu√© es una direcci√≥n IP?",
  tags:["ip","red","ipv4","ipv6"],
  content:`
Direcci√≥n √∫nica que identifica dispositivos en una red.

Tipos:
- Privada
- P√∫blica
- Est√°tica
- Din√°mica

Ejemplo IPv4: 192.168.1.10
  `
},

{
  id:"latencia-red",
  title:"¬øQu√© es la latencia?",
  tags:["red","latencia","ping"],
  content:`
La latencia es el tiempo que tarda un paquete en viajar.
Se mide en ms.
Valores buenos: 1‚Äì40 ms.
  `
},

{
  id:"dns",
  title:"¬øQu√© es el DNS?",
  tags:["dns","nombres de dominio","red"],
  content:`
DNS traduce nombres como google.com a direcciones IP.
Es como la agenda telef√≥nica de Internet.
  `
},

{
  id:"cable-utp",
  title:"Tipos de cable UTP",
  tags:["utp","cable","ethernet"],
  content:`
Categor√≠as:
- Cat5e ‚Üí 1 Gbps
- Cat6 ‚Üí 1‚Äì10 Gbps
- Cat6a ‚Üí 10 Gbps
- Cat7/8 ‚Üí alta gama

Usos:
- Redes LAN
- Conexiones de PC a router
  `
},

{
  id:"router",
  title:"¬øQu√© es un router?",
  tags:["router","red","wifi"],
  content:`
Dispositivo que distribuye internet entre dispositivos.

Funciones:
- DHCP
- NAT
- Firewall
- WiFi
  `
},

{
  id:"switch",
  title:"¬øQu√© es un switch?",
  tags:["switch","red","lan"],
  content:`
Un switch conecta dispositivos en una red local.

Tipos:
- No gestionado
- Gestionado
- PoE (Power over Ethernet)
  `
},

{
  id:"formateo",
  title:"¬øQu√© es formatear una PC?",
  tags:["formateo","reinstalar windows","limpiar pc"],
  content:`
Proceso donde se reinstala el sistema operativo.

Razones:
- Virus
- Lentitud
- Corrupci√≥n del sistema
- Cambio de disco

Precauci√≥n: siempre respaldar datos.
  `
},

{
  id:"backup",
  title:"¬øQu√© es un respaldo?",
  tags:["backup","respaldo","copia de seguridad"],
  content:`
Copia de datos para prevenir p√©rdida.

M√©todos:
- Cloud
- USB
- Disco externo
- NAS
  `
},

{
  id:"windows-def",
  title:"Versiones de Windows m√°s usadas",
  tags:["windows","os","sistemas"],
  content:`
Windows 10:
- Estable, soporte amplio

Windows 11:
- Requiere TPM 2.0
- Mejor rendimiento en hardware moderno
  `
},

{
  id:"linux-def",
  title:"Distribuciones Linux populares",
  tags:["linux","ubuntu","mint","debian"],
  content:`
Principales distribuciones:
- Ubuntu
- Linux Mint
- Debian
- Fedora

Ventajas:
- Gratis
- Seguro
- Ideal para servidores
  `
},

{
  id:"antivirus",
  title:"¬øQu√© es un antivirus?",
  tags:["antivirus","seguridad","defender"],
  content:`
Detecta y elimina malware.

Opciones:
- Windows Defender
- Bitdefender
- Kaspersky
- ESET
  `
},

{
  id:"malware",
  title:"Tipos de malware",
  tags:["malware","virus","gusanos","troyanos"],
  content:`
Tipos:
- Virus
- Gusanos
- Troyanos
- Ransomware
- Spyware

Prevenci√≥n:
- Antivirus
- Actualizaciones
- No abrir adjuntos sospechosos
  `
},

{
  id:"ping",
  title:"¬øQu√© es un ping?",
  tags:["ping","red","latencia"],
  content:`
Ping mide el tiempo que tarda un paquete en ir y regresar.
Sirve para diagnosticar problemas de red.
  `
},

{
  id:"tracert",
  title:"¬øQu√© es tracert?",
  tags:["tracert","traceroute","red"],
  content:`
Tracert muestra la ruta que toman los paquetes.
√ötil para identificar d√≥nde se generan retrasos o ca√≠das.
  `
},

{
  id:"firewall",
  title:"¬øQu√© es un firewall?",
  tags:["firewall","seguridad","red"],
  content:`
Sistema que bloquea accesos no autorizados.
Puede ser:
- Software
- Hardware
  `
},

{
  id:"ipconfig",
  title:"Comandos √∫tiles de red",
  tags:["ipconfig","ifconfig","comandos","diagnostico"],
  content:`
Windows:
- ipconfig /all
- ping
- tracert

Linux:
- ifconfig
- ip a
- ping
  `
},

{
  id:"ram-diagnostico",
  title:"Diagn√≥stico de RAM (ampliado)",
  tags:["ram","memtest","errores","diag"],
  content:`
S√≠ntomas:
- BSOD
- Aplicaciones cerr√°ndose
- Reinicios aleatorios

Herramientas:
- MemTest86
- Windows Memory Diagnostic

Soluciones:
- Probar m√≥dulos individualmente
- Limpiar contactos
- Cambiar ranuras
  `
},

{
  id:"psu-diagnostico",
  title:"Diagn√≥stico de fuente de poder",
  tags:["psu","voltaje","tester"],
  content:`
Procedimientos:
- Mult√≠metro: medir 12V, 5V, 3.3V
- Tester ATX
- Verificar cables flojos
  `
},

{
  id:"gpu-fallas",
  title:"Fallas comunes de GPU",
  tags:["gpu","artefactos","pantalla negra"],
  content:`
S√≠ntomas:
- Artefactos
- Pantalla negra
- Drivers fallando

Soluciones:
- Reinstalar drivers
- Cambiar cable/video
- Bajar temperaturas
- Limpiar polvo
  `
},

{
  id:"cpu-fallas",
  title:"Fallas en CPU",
  tags:["cpu","temperatura","rendimiento"],
  content:`
Causas de fallas:
- Altas temperaturas
- Overclock inestable
- Pasta t√©rmica seca
  `
}

];

// Cargar knowledge desde localStorage (si existe)
try {
  const rawK = localStorage.getItem(KNOW_KEY);
  if(rawK){ const parsedK = JSON.parse(rawK); if(Array.isArray(parsedK) && parsedK.length) knowledge = parsedK; }
} catch(e){ console.warn('Knowledge parse error', e); }

// Funciones para guardar knowledge si lo editas din√°micamente
function saveKnowledge(){ localStorage.setItem(KNOW_KEY, JSON.stringify(knowledge)); }



    // Cargar KB desde localStorage si existe
    try {
      const rawKb = localStorage.getItem(KB_KEY);
      if(rawKb){ const parsed = JSON.parse(rawKb); if(Array.isArray(parsed) && parsed.length) kbModules = parsed; }
    } catch(e){ console.warn('KB parse error', e); }

    // Chat history
    let chatHistory = [];
    try { chatHistory = JSON.parse(localStorage.getItem(MSG_KEY) || '[]'); } catch(e){ chatHistory = []; }

    /* ---------- Helpers ---------- */
    function escapeHTML(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('\"','&quot;'); }
    function formatBubbleText(s){
      if(!s) return '';
      return escapeHTML(s).replace(/(\r\n|\r|\n){2,}/g,'<br><br>').replace(/(\r\n|\r|\n)/g,'<br>');
    }
    function nowString(){ return new Date().toLocaleString(); }

    function saveHistory(){ localStorage.setItem(MSG_KEY, JSON.stringify(chatHistory)); }
    function saveKB(){ localStorage.setItem(KB_KEY, JSON.stringify(kbModules)); }

    /* ---------- Render mensajes ---------- */
    function renderMessages(){
      messagesEl.innerHTML = '';
      chatHistory.forEach(m=>{
        const wrap = document.createElement('div');
        wrap.className = 'max-w-[78%] ';
        if(m.role==='user'){
          wrap.className += 'ml-auto text-right';
          wrap.innerHTML = `
            <div class="inline-block p-3 rounded-2xl bubble-user card-anim shadow-sm">
              <div class="text-sm whitespace-pre-wrap">${formatBubbleText(m.text)}</div>
              <div class="text-[10px] mt-2 text-white/70">${escapeHTML(m.time)}</div>
            </div>`;
        } else {
          wrap.className += 'mr-auto text-left';
          wrap.innerHTML = `
            <div class="inline-block p-3 rounded-2xl bubble-assistant card-anim shadow-sm">
              <div class="text-sm whitespace-pre-wrap">${formatBubbleText(m.text)}</div>
              <div class="text-[10px] mt-2 text-slate-500">${escapeHTML(m.time)}</div>
            </div>`;
        }
        messagesEl.appendChild(wrap);
      });
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function addMessage(role, text){
      const entry = { id: uid('m'), role, text, time: nowString() };
      chatHistory.push(entry);
      saveHistory();
      renderMessages();
    }

    /* ---------- L√≥gica local y b√∫squeda ---------- */
    function detectGreeting(text){
      const t = String(text).toLowerCase();
      const saludos = ['hola','buenos d√≠as','buenas tardes','buenas noches','buen d√≠a','buenas','qu√© tal'];
      for(const s of saludos) if(t.includes(s)) return true;
      return false;
    }
    function detectFarewell(text){ const t = String(text).toLowerCase(); const bye = ['adi√≥s','chao','hasta luego','nos vemos']; for(const b of bye) if(t.includes(b)) return true; return false; }
    function detectThanks(text){ const t = String(text).toLowerCase(); const thanks = ['gracias','muchas gracias']; for(const w of thanks) if(t.includes(w)) return true; return false; }

   function localAnswer(prompt){
  const q = String(prompt).trim();
  if(!q) return "¬°Hola! Soy Yiyi. ¬øEn qu√© puedo ayudarte hoy? üòä";

  // Respuestas de cortes√≠a
  if(detectGreeting(q)) return "¬°Hola! üòä Soy Yiyi, tu asistente de Soporte y Mantenimiento. ¬øEn qu√© te ayudo?";
  if(detectFarewell(q)) return "¬°Hasta luego! üòä";
  if(detectThanks(q)) return "Con gusto ‚ú®";

  const ql = q.toLowerCase();
  let matches = [];

  // 1) Buscar en kbModules (estructura de cat√°logo/m√≥dulos)
  kbModules.forEach(mod=>{
    mod.items.forEach(it=>{
      const hay = (it.title + ' ' + (it.tags||[]).join(' ') + ' ' + (it.summary||'') + ' ' + (it.content||'')).toLowerCase();
      if(hay.includes(ql)) matches.push({source: 'module', mod: mod.title, item: it});
    });
  });

  // 2) Buscar en knowledge (conceptos sueltos)
  knowledge.forEach(k=>{
    const hay = (k.title + ' ' + (k.tags||[]).join(' ') + ' ' + (k.content||'')).toLowerCase();
    if(hay.includes(ql)) matches.push({source: 'concept', item: k});
  });

  // Si hay resultados, priorizar y formatear salida
  if(matches.length > 0){
    // Opcional: ordenar por fuente (modules primero) o por relevancia simple
    const modulesMatches = matches.filter(m=>m.source === 'module');
    const conceptMatches = matches.filter(m=>m.source === 'concept');

    const ordered = modulesMatches.concat(conceptMatches);
    const top = ordered.slice(0,6); // mostrar hasta 6 resultados

    let out = `Encontr√© ${matches.length} resultado(s) relacionados:\n\n`;
    top.forEach(m => {
      if(m.source === 'module'){
        out += `‚Äî ${m.item.title} (${m.mod}):\n${m.item.summary}\nDetalle:\n${m.item.content}\n\n`;
      } else { // concept
        out += `‚Äî ${m.item.title} (Concepto):\n${m.item.content}\n\n`;
      }
    });

    if(matches.length > top.length) out += `Y ${matches.length - top.length} resultado(s) m√°s. Afina tu b√∫squeda para verlos.\n`;
    return out;
  }

  // Si no encontr√≥ nada, sugerencias
  return `No encontr√© informaci√≥n directa para "${prompt}". Prueba con alguna de estas sugerencias:\n‚Ä¢ "clonar SSD"\n‚Ä¢ "diagn√≥stico RAM"\n‚Ä¢ "instalar Windows desde USB"`;
}

    /* ---------- Env√≠o y flujo de chat ---------- */
    function sendUserMessage(text){
      if(!text || !String(text).trim()) return;
      addMessage('user', text);
      inputMsg.value = '';
      const typingWrap = document.createElement('div');
      typingWrap.className = 'mr-auto';
      typingWrap.innerHTML = `<div class="inline-block p-3 rounded-2xl bg-white/6 text-slate-200"><div class="typing-dots"><span></span><span></span><span></span></div></div>`;
      messagesEl.appendChild(typingWrap);
      messagesEl.scrollTop = messagesEl.scrollHeight;

      const thinkDelay = 400 + Math.min(1500, text.length * 6);
      setTimeout(()=> {
        if(typingWrap && typingWrap.parentNode) typingWrap.parentNode.removeChild(typingWrap);
        const ans = localAnswer(text);
        addMessage('assistant', ans);
        // speak (with voice selection)
        try { speak(ans.replace(/\*/g,'')); } catch(e){}
      }, thinkDelay);
    }

    // handlers
    sendBtn.addEventListener('click', ()=> sendUserMessage(inputMsg.value));
    inputMsg.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); sendUserMessage(inputMsg.value); }
    });

    btnQuick.addEventListener('click', ()=>{
      const templates = [
        'Diagn√≥stico r√°pido: equipo no enciende',
        'Checklist preventivo para laptop (aula)',
        'Comandos para comprobar red en Windows',
        'Pasos para clonar HDD a SSD'
      ];
      const selection = prompt('Elige plantilla (escribe n√∫mero):\n' + templates.map((v,i)=>`${i+1}. ${v}`).join('\n'));
      const idx = parseInt(selection)-1;
      if(!isNaN(idx) && templates[idx]) inputMsg.value = templates[idx];
    });

    // keyboard shortcuts
    document.addEventListener('keydown', (e)=>{
      if(e.ctrlKey && e.key.toLowerCase()==='k'){ e.preventDefault(); kbSearch.focus(); }
      if(e.ctrlKey && (e.key === 'Enter')){ e.preventDefault(); sendBtn.click(); }
    });

    // clear chat
    btnClear.addEventListener('click', ()=> {
      if(confirm('¬øBorrar historial de chat?')) {
        chatHistory = [];
        localStorage.removeItem(MSG_KEY);
        renderMessages();
      }
    });

    /* voice: prefer female, fallback to any Spanish voice */
    let selectedVoice = null;
    function loadVoices(){
      const voices = speechSynthesis.getVoices();
      if (!voices.length) return;
      // Try to find a female voice (common names or labels)
      selectedVoice = voices.find(v =>
        v.lang && v.lang.toLowerCase().includes('es') &&
        (v.name.toLowerCase().includes('sabina') || v.name.toLowerCase().includes('female') || v.name.toLowerCase().includes('maria') || v.name.toLowerCase().includes('soledad') || v.name.toLowerCase().includes('laura') || v.name.toLowerCase().includes('lina'))
      );
      if (!selectedVoice) selectedVoice = voices.find(v => v.lang && v.lang.toLowerCase().includes('es'));
    }
    speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    function speak(text){
      if (!('speechSynthesis' in window)) return;
      // ensure voices are loaded (Chrome/Edge may delay)
      if (!speechSynthesis.getVoices().length) {
        // try reloading once
        loadVoices();
      }
      const msg = new SpeechSynthesisUtterance(text);
      msg.lang = 'es-MX';
      if (selectedVoice) msg.voice = selectedVoice;
      // adjust rate/volume if you want
      msg.rate = 1;
      msg.volume = 1;
      speechSynthesis.cancel();
      try { speechSynthesis.speak(msg); } catch(e){}
    }

    /* ---------- Render KB (UI) with MAX_VISIBLE_ITEMS behavior ---------- */
    function renderKB(filter=''){
      kbList.innerHTML = '';
      kbModules.forEach(mod=>{
        const matchingItems = mod.items.filter(it=>{
          const hay = (it.title + ' ' + (it.tags||[]).join(' ') + ' ' + (it.summary||'') + ' ' + (it.content||'')).toLowerCase();
          return hay.includes(filter.toLowerCase());
        });
        if(matchingItems.length === 0) return;

        const card = document.createElement('div');
        card.className = 'p-3 rounded-xl bg-white/4 border border-white/6 card-anim';

        card.innerHTML = `<div class="flex items-center justify-between">
            <div>
              <h4 class="text-md font-semibold">${escapeHTML(mod.title)}</h4>
              <p class="text-xs text-slate-300">${matchingItems.length} entrada(s)</p>
            </div>
            <div>
              <button class="px-2 py-1 text-xs rounded-lg bg-white/6 viewBtn">Ver</button>
            </div>
          </div>
          <div class="mt-3 grid gap-2 items-container"></div>`;

        kbList.appendChild(card);

        const container = card.querySelector('.items-container');
        matchingItems.forEach((it, index) => {
          const hiddenClass = index >= MAX_VISIBLE_ITEMS ? 'hiddenItem' : '';
          const itemHtml = document.createElement('div');
          itemHtml.className = `p-2 rounded-lg bg-white/5 ${hiddenClass} catalog-item`;
          itemHtml.setAttribute('data-mod', mod.id);
          itemHtml.innerHTML = `
            <div class="flex items-start justify-between">
              <div>
                <div class="text-sm font-medium">${escapeHTML(it.title)}</div>
                <div class="text-[11px] text-slate-300">${escapeHTML(it.summary)}</div>
              </div>
              <div class="text-xs text-slate-400 ml-3">${it.tags ? escapeHTML(it.tags.slice(0,2).join(', ')) : ''}</div>
            </div>
          `;
          container.appendChild(itemHtml);
        });

        if (matchingItems.length > MAX_VISIBLE_ITEMS) {
          const toggle = document.createElement('div');
          toggle.className = 'mt-2';
          toggle.innerHTML = `<button class="toggleBtn" data-mod="${escapeHTML(mod.id)}">Ver m√°s</button>`;
          card.appendChild(toggle);
        }

        // bind view button
        card.querySelectorAll('.viewBtn').forEach(b=>{
          b.addEventListener('click', ()=> openModuleModal(mod));
        });
      });
    }

    // Toggle behavior for Ver m√°s / Ver menos
    document.addEventListener('click', (e) => {
      if (!e.target.classList.contains('toggleBtn')) return;
      const modId = e.target.getAttribute('data-mod');
      const selector = `.catalog-item[data-mod="${modId}"]`;
      const items = Array.from(document.querySelectorAll(selector));
      if (!items.length) return;
      const anyHidden = items.some(it => it.classList.contains('hiddenItem'));
      if (anyHidden) {
        items.forEach(it => it.classList.remove('hiddenItem'));
        e.target.textContent = 'Ver menos';
      } else {
        items.forEach((it, idx) => { if (idx >= MAX_VISIBLE_ITEMS) it.classList.add('hiddenItem'); });
        e.target.textContent = 'Ver m√°s';
      }
    });

    function openModuleModal(mod){
      modalRoot.innerHTML = `
        <div id="modalOverlay" class="fixed inset-0 bg-black/50 flex items-center justify-center z-40">
          <div class="w-[95%] max-w-3xl bg-gradient-to-b from-white/6 to-white/2 p-4 rounded-2xl border border-white/8">
            <div class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-semibold">${escapeHTML(mod.title)}</h3>
                <p class="text-xs text-slate-300">${mod.items.length} entradas</p>
              </div>
              <div><button id="closeModal" class="px-3 py-1 rounded-lg bg-white/6">Cerrar</button></div>
            </div>
            <div id="modalContent" class="mt-4 space-y-3 max-h-[60vh] overflow-auto pr-2">
              ${mod.items.map(it=>`
                <div class="p-3 rounded-xl bg-white/5">
                  <div class="flex items-center justify-between">
                    <div>
                      <div class="font-medium">${escapeHTML(it.title)}</div>
                      <div class="text-xs text-slate-300">${escapeHTML(it.summary)}</div>
                    </div>
                    <div class="text-xs text-slate-400">${it.tags ? escapeHTML(it.tags.join(', ')) : ''}</div>
                  </div>
                  <details class="mt-2 text-sm"><summary class="cursor-pointer">Ver detalle</summary><pre class="whitespace-pre-wrap text-[13px] mt-2">${escapeHTML(it.content)}</pre></details>
                  <div class="mt-2 flex gap-2">
                    <button class="px-2 py-1 rounded-lg bg-indigo-500 text-sm copyBtn">Copiar</button>
                    <button class="px-2 py-1 rounded-lg bg-emerald-500 text-sm insertBtn">Enviar al chat</button>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
      const closeModal = $('closeModal');
      if(closeModal) closeModal.addEventListener('click', ()=> modalRoot.innerHTML = '');

      const copyBtns = modalRoot.querySelectorAll('.copyBtn');
      const insertBtns = modalRoot.querySelectorAll('.insertBtn');
      copyBtns.forEach((b,i)=> b.addEventListener('click', ()=> {
        const text = mod.items[i].content;
        navigator.clipboard.writeText(text).then(()=> alert('Copiado al portapapeles'), ()=> alert('No se pudo copiar'));
      }));
      insertBtns.forEach((b,i)=> b.addEventListener('click', ()=> {
        addMessage('user', `Solicito: ${mod.items[i].title}`);
        addMessage('assistant', mod.items[i].content);
        modalRoot.innerHTML = '';
      }));
    }

    kbSearch.addEventListener('input', (e)=> renderKB(e.target.value.trim()));

    exportKB.addEventListener('click', ()=> {
      const blob = new Blob([JSON.stringify(kbModules, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'yiyi_kb_export.json'; document.body.appendChild(a); a.click();
      a.remove(); URL.revokeObjectURL(url);
    });

    // flashcards / estudio
    studyBtn.addEventListener('click', ()=> {
      const pool = kbModules.flatMap(m=>m.items).slice(0,120);
      if(pool.length === 0){ alert('No hay contenido para estudiar.'); return; }
      let idx = 0;
      modalRoot.innerHTML = `
        <div class="fixed inset-0 bg-black/60 flex items-center justify-center z-40">
          <div class="w-[92%] max-w-2xl p-4 rounded-2xl bg-gradient-to-b from-white/6 to-white/3 border border-white/8">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-lg font-semibold">Flashcards ‚Äî Modo Estudio</h4>
              <button id="closeStudy" class="px-2 py-1 rounded-lg bg-white/6">Cerrar</button>
            </div>
            <div id="cardArea" class="min-h-[220px] flex items-center justify-center p-6"></div>
            <div class="mt-4 flex justify-between">
              <div><button id="prevCard" class="px-3 py-2 rounded-lg bg-white/6">Anterior</button></div>
              <div class="flex gap-2">
                <button id="flipCard" class="px-3 py-2 rounded-lg bg-indigo-500">Mostrar respuesta</button>
                <button id="nextCard" class="px-3 py-2 rounded-lg bg-emerald-500">Siguiente</button>
              </div>
            </div>
          </div>
        </div>
      `;
      function renderCard(i, showAnswer=false){
        const it = pool[i];
        const area = $('cardArea');
        area.innerHTML = `<div class="p-6 rounded-xl bg-white/5 w-full">
          <div class="text-sm text-slate-300">Tema: ${escapeHTML(it.title)}</div>
          <div class="mt-3 text-base">${showAnswer ? '<pre class="whitespace-pre-wrap text-[14px]">' + escapeHTML(it.content) + '</pre>' : '<div class="font-medium">' + escapeHTML(it.summary) + '</div>'}</div>
        </div>`;
      }
      renderCard(idx,false);
      $('closeStudy').addEventListener('click', ()=> modalRoot.innerHTML = '');
      $('flipCard').addEventListener('click', ()=> renderCard(idx, true));
      $('nextCard').addEventListener('click', ()=> { idx = (idx+1) % pool.length; renderCard(idx, false); });
      $('prevCard').addEventListener('click', ()=> { idx = (idx-1 + pool.length) % pool.length; renderCard(idx, false); });
    });

    // Open buttons
    openChat.addEventListener('click', ()=> { window.scrollTo({ top: 0, behavior: 'smooth' }); $('chatPanel').scrollIntoView({ behavior:'smooth' }); });
    openKB.addEventListener('click', ()=> { window.scrollTo({ top: 0, behavior: 'smooth' }); $('kbPanel').scrollIntoView({ behavior:'smooth' }); });

    // allow import via paste (JSON)
    window.addEventListener('paste', (e)=> {
      try {
        const txt = (e.clipboardData || window.clipboardData).getData('text');
        if(!txt) return;
        const parsed = JSON.parse(txt);
        if(Array.isArray(parsed)){
          if(confirm('JSON detectado en portapapeles. ¬øImportar como base de conocimiento?')) {
            kbModules = parsed;
            saveKB();
            renderKB();
            alert('Importaci√≥n completada.');
          }
        }
      } catch(e){}
    });

    /* Inicializaci√≥n */
    renderKB();
    renderMessages();

    // Saludo proactivo
    if(chatHistory.length === 0){
      addMessage('assistant', '¬°Hola! üòä Soy Yiyi, tu asistente de Soporte y Mantenimiento. ¬øEn qu√© puedo ayudarte hoy?');
    }
  </script>
</body>
</html>
